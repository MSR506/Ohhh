<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Keyframes Generator</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      margin: 50px;
    }

    p {
      font-size: 1.5em;
      filter: brightness(80%) contrast(0%);
      cursor: pointer;
    }

    #output {
      margin-top: 20px;
      padding: 20px;
      background-color: #f0f0f0;
      border: 1px solid #ddd;
      white-space: pre-wrap;
      font-family: monospace;
      font-size: 1.1em;
    }

    #output-header {
      font-weight: bold;
      margin-bottom: 10px;
    }

    .modal {
      display: none;
      position: fixed;
      z-index: 1;
      left: 0;
      top: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
    }

    .modal-content {
      background-color: white;
      margin: 15% auto;
      padding: 20px;
      border: 1px solid #888;
      width: 80%;
      max-width: 400px;
    }

    .close {
      color: #aaa;
      float: right;
      font-size: 28px;
      font-weight: bold;
      cursor: pointer;
    }

    .close:hover,
    .close:focus {
      color: black;
      text-decoration: none;
      cursor: pointer;
    }

    .delete-btn {
      filter: brightness(0) saturate(100%) invert(31%) sepia(100%) saturate(7337%) hue-rotate(-15deg) brightness(99%) contrast(119%);
      margin-left: 20px;
    }

    .locked {
      filter: contrast(0%) brightness(80%);
    }

    .delete-btn:hover {
      text-decoration: underline;
    }

    .variable-input {
      width: 60px;
      margin-right: 10px;
    }

    table {
      width: 100%;
      margin-bottom: 20px;
      border-collapse: collapse;
    }

    table,
    th,
    td {
      border: .5px solid #353535;
    }

    td {
      padding: 5px;
      padding-right: 20px;
      display: flex;
      justify-content: flex-start;
      align-items: center;
      position: relative;
    }

    .locked,
    .delete-btn {
      margin-left: auto;
    }

    .button-container {
      display: flex;
      justify-content: space-between;
      margin-top: 10px;
    }

    #button-container button {
      width: 49%;
      padding: 5px;
      cursor: pointer;
    }
  </style>

  <script>
    let variableList = [{ value: 35, name: 'j' }, { value: 75, name: 'k' }];
    let tempVariableList = [];
    let changesMade = false;

    function openModal() {
      tempVariableList = JSON.parse(JSON.stringify(variableList));
      changesMade = false;
      document.getElementById('popupModal').style.display = 'block';
      updateVariableList(tempVariableList);
    }

    function closeModal() {
      document.getElementById('popupModal').style.display = 'none';
    }

    function updateValues() {
      const inputs = document.querySelectorAll('.variable-input');
      inputs.forEach(input => {
        const index = input.getAttribute('data-index');
        if (tempVariableList[index]) {
          tempVariableList[index].value = parseFloat(input.value) || tempVariableList[index].value;
        }
      });
      variableList = JSON.parse(JSON.stringify(tempVariableList));
      changesMade = false;
      closeModal();
    }

    function addVariable() {
      const newVariableValue = parseFloat(prompt("Enter a new variable value (%):"));
      if (!isNaN(newVariableValue) && newVariableValue > 0 && newVariableValue < 100) {
        tempVariableList.push({
          value: newVariableValue,
          name: `var${tempVariableList.length + 1}`
        });
        updateVariableList(tempVariableList);
        changesMade = true;
      } else {
        alert("Please enter a valid number between 0 and 100.");
      }
    }

    function deleteVariable(index) {
      tempVariableList.splice(index, 1);
      updateVariableList(tempVariableList);
      changesMade = true;
    }

    function updateVariableList(list) {
      const variableListDiv = document.getElementById('variableList');
      let tableHTML = `
        <table>
          <tr>
            <td><input type="number" class="variable-input" value="0" readonly>
            <span>%</span><span class="locked">üîí</span></td>
          </tr>`;
      list.sort((a, b) => a.value - b.value);
      list.forEach((variable, index) => {
        tableHTML += `
          <tr>
            <td><input type="number" class="variable-input" data-index="${index}" value="${variable.value}" min="0" max="100" step="1" oninput="changesMade = true;">
            <span>%</span><span class="delete-btn" onclick="deleteVariable(${index})">üóëÔ∏è</span></td>
          </tr>`;
      });
      tableHTML += `
          <tr>
            <td><input type="number" class="variable-input" value="100" readonly>
            <span>%</span><span class="locked">üîí</span></td>
          </tr>
        </table><br>`;
      variableListDiv.innerHTML = tableHTML;
    }

    function calculateValues() {
      const s = parseFloat(document.getElementById('s').value);
      const p = parseFloat(document.getElementById('p').value);

      if (isNaN(s) || isNaN(p) || s <= 0 || p <= 0) {
        alert("Enter valid positive numbers for animation and pause duration.");
        return;
      }

      const m = s + p;
      variableList.sort((a, b) => a.value - b.value);

      const keyframeValues = variableList.map(v => ({
        percent: (v.value / 100) * s,
        percentOfTotal: ((v.value / 100) * s / m) * 100
      }));

      let output = `
@keyframes name {
    0% {

    }
`;

      keyframeValues.forEach(item => {
        output += `    ${Math.round(item.percentOfTotal * 1000) / 1000}% {

    }\n`;
      });

      output += `    ${Math.round((s / m) * 100 * 1000) / 1000}% {

    }
    100% {

    }
}`;

      document.getElementById('output').textContent = output;
      document.getElementById('m').value = m;
      document.getElementById('m-label').style.display = 'block';
      document.getElementById('m').style.display = 'block';
      document.getElementById('gaph').style.display = 'none';
    }

    function highlightModal() {
      const modalContent = document.querySelector('.modal-content');
      modalContent.style.transition = 'background-color 0.3s ease';

      modalContent.style.backgroundColor = '#aaa';
      setTimeout(() => {
        modalContent.style.backgroundColor = '#fff';
        setTimeout(() => {
          modalContent.style.backgroundColor = '#aaa';
          setTimeout(() => {
            modalContent.style.backgroundColor = '#fff';
          }, 400);
        }, 300);
      }, 300);
    }

    document.addEventListener('DOMContentLoaded', function () {
      const inputField = document.getElementById('m');

      if (inputField) {
        inputField.addEventListener('click', function () {
          navigator.clipboard.writeText(inputField.value);
        });
      }

      const modal = document.getElementById('popupModal');
      modal.addEventListener('click', function (event) {
        if (event.target === modal) {
          const hasChanges = JSON.stringify(tempVariableList) !== JSON.stringify(variableList);
          if (hasChanges) {
            highlightModal();
          } else {
            closeModal();
          }
        }
      });
    });
  </script>
</head>

<body>

  <p onclick="openModal()">‚öôÔ∏è</p>

  <form id="keyframeForm" onsubmit="event.preventDefault(); calculateValues();">
    <label for="s">Animation Duration (ms): </label>
    <input type="number" id="s" name="s" min="0" step="1" required><br><br>

    <label for="p">Pause Duration (ms): </label>
    <input type="number" id="p" name="p" min="0" step="1" required><br><br>

    <button type="submit" style="width: 190px;">Submit</button><br><br>
  </form>

  <label id="m-label" for="m" style="display: none;">Total Duration (ms): </label>
  <input type="number" id="m" readonly style="display: none; margin-bottom: 1em;">

  <div id="gaph" style="display: block; height: 3em"></div>

  <div id="output-header">Calculated @keyframes :</div>
  <div id="output"></div>

  <div id="popupModal" class="modal">
    <div class="modal-content">
      <span class="close" onclick="closeModal()">&times;</span>
      <h2>Adjust Keyframe Values</h2>
      <div id="variableList"></div>
      <div id="button-container">
        <button onclick="addVariable()">Add Variable</button>
        <button onclick="updateValues()">Save Changes</button>
      </div>
    </div>
  </div>

</body>

</html>
